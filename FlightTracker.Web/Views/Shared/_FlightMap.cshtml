@* Reusable flight map component with header + search.
   Configure height by passing ViewData["FlightMapHeight"] (e.g. "70vh", "500px"). *@
@{
    var mapHeight = (ViewData["FlightMapHeight"] as string)?.Trim();
    if (string.IsNullOrWhiteSpace(mapHeight)) { mapHeight = "50vh"; }
}
@using System.Text.Json
@{
    var flightsJson = "[]";
    int mapFlightCount = 0;
    if (Model is FlightTracker.Web.Models.ViewModels.DashboardViewModel dvm && dvm.MapFlights != null)
    {
        var list = dvm.MapFlights.ToList();
        mapFlightCount = list.Count;
        flightsJson = JsonSerializer.Serialize(list, new JsonSerializerOptions { PropertyNamingPolicy = JsonNamingPolicy.CamelCase });
    }
}
<div class="flight-map" data-flight-map data-map-flight-count="@mapFlightCount">
    <div class="flight-map__header">
        <h2 class="flight-map__title">Flight Overview</h2>
        <form class="flight-map__search" role="search" onsubmit="return false;">
            <span class="material-icons flight-map__search-icon" aria-hidden="true">search</span>
            <input id="flightSearch" type="text" placeholder="Search flights" aria-label="Search flights" />
        </form>
    </div>
    <div id="flightMap" class="flight-map__map" style="min-height:@mapHeight;" aria-label="Flight map" role="region"></div>
    <script type="application/json" id="flightMapData">@Html.Raw(flightsJson)</script>
    <script>
        console.log('[flight-map] view embedded mapFlightCount=@mapFlightCount');
        const _fmd = document.getElementById('flightMapData');
        console.log('[flight-map] script tag length', _fmd ? (_fmd.textContent||'').length : 'missing');
    </script>
</div>
